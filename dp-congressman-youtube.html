<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="generator" content="pandoc">
    <title>Software Carpentry: xwMOOC 데이터 제품</title>
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" type="text/css" href="css/bootstrap/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="css/bootstrap/bootstrap-theme.css" />
    <link rel="stylesheet" type="text/css" href="css/swc.css" />
    <link rel="alternate" type="application/rss+xml" title="Software Carpentry Blog" href="http://software-carpentry.org/feed.xml"/>
    <meta charset="UTF-8" />
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="https://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
    
      ga('create', 'UA-59802572-17', 'auto');
      ga('send', 'pageview');
    
    </script>
  </head>
  <body class="lesson">
    <div class="container card">
      <div class="banner">
        <a href="http://software-carpentry.org" title="Software Carpentry">
          <img alt="Software Carpentry banner" src="img/software-carpentry-banner.png" />
        </a>
      </div>
      <article>
      <div class="row">
        <div class="col-md-10 col-md-offset-1">
                    <a href="index.html"><h1 class="title">xwMOOC 데이터 제품</h1></a>
          <h2 class="subtitle">국회의원(20대) - 유튜브</h2>
          <h1 id="dp-congressman-youtube-workflow">작업흐름</h1>
<h1 id="dp-congressman-youtube-workflow-crawling">데이터 긁어오기 <a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></h1>
<h2 id="dp-congressman-youtube-workflow-crawling-list">제20대 국회의원 목록</h2>
<p>가장 먼저 제20대 국회의원 목록이 필요하다. 이를 위해서 위키백과사전에서 <a href="https://ko.wikipedia.org/wiki/대한민국_제20대_국회의원_목록_(지역구별)">대한민국 제20대 국회의원 목록 (지역구별)</a>를 긁어오자.</p>
<p>위키백과사전에서 ULR을확인했으니 rvest 팩키지를 활용하여 xpath를 찾아 이를 서울특별시부터, 제주도까지 긁어온다.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a><span class="co"># 0. 환경설정 -----</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a><span class="kw">library</span>(httr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true"></a><span class="kw">library</span>(rvest)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true"></a><span class="kw">library</span>(urltools)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true"></a><span class="kw">library</span>(glue)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true"></a><span class="kw">library</span>(extrafont)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true"></a><span class="kw">loadfonts</span>()</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true"></a><span class="kw">Sys.setlocale</span>(<span class="st">&quot;LC_ALL&quot;</span>, <span class="st">&quot;C&quot;</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true"></a>url &lt;-<span class="st"> &quot;https://ko.wikipedia.org/wiki/대한민국_제20대_국회의원_목록_(지역구별)&quot;</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true"></a>cm_list &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="dt">length=</span><span class="dv">19</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true"></a><span class="cf">for</span>(idx <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">17</span>) {</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true"></a>  cm_list[[idx]] &lt;-<span class="st"> </span><span class="kw">GET</span>(<span class="dt">url =</span> url) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true"></a><span class="st">    </span><span class="kw">read_html</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true"></a><span class="st">    </span><span class="kw">html_node</span>(<span class="dt">xpath =</span> <span class="kw">glue</span>(<span class="st">&#39;//*[@id=&quot;mw-content-text&quot;]/div/table[&#39;</span>, idx<span class="op">+</span><span class="dv">2</span>, <span class="st">&#39;]&#39;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true"></a><span class="st">    </span><span class="kw">html_table</span>(<span class="dt">fill=</span><span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true"></a><span class="st">    </span><span class="kw">as_tibble</span>()</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true"></a>}</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true"></a><span class="kw">Sys.setlocale</span>(<span class="st">&quot;LC_ALL&quot;</span>, <span class="st">&quot;Korean&quot;</span>)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true"></a><span class="co">## 1.2. 시도별 국회의원 정보 -----</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true"></a>cm_list &lt;-<span class="st"> </span>cm_list[<span class="dv">1</span><span class="op">:</span><span class="dv">17</span>] </span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true"></a><span class="kw">names</span>(cm_list) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;서울특별시&quot;</span>,<span class="st">&quot;부산광역시&quot;</span>,<span class="st">&quot;대구광역시&quot;</span>,<span class="st">&quot;인천광역시&quot;</span>,<span class="st">&quot;광주광역시&quot;</span>,<span class="st">&quot;대전광역시&quot;</span>,<span class="st">&quot;울산광역시&quot;</span>,<span class="st">&quot;세종특별자치시&quot;</span>,<span class="st">&quot;경기도&quot;</span>,<span class="st">&quot;강원도&quot;</span>,<span class="st">&quot;충청북도&quot;</span>,<span class="st">&quot;충청남도&quot;</span>,<span class="st">&quot;전라북도&quot;</span>,<span class="st">&quot;전라남도&quot;</span>,<span class="st">&quot;경상북도&quot;</span>,<span class="st">&quot;경상남도&quot;</span>, <span class="st">&quot;제주특별자치도&quot;</span>)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true"></a></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true"></a><span class="co">## 2.3. 리스트 --&gt; 데이터프레임 -----</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true"></a></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true"></a>name_v &lt;-<span class="st"> </span><span class="kw">map</span>(cm_list, <span class="st">&quot;이름&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>flatten <span class="op">%&gt;%</span><span class="st"> </span>unlist <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.character</span>()</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true"></a>precinct_v &lt;-<span class="st"> </span><span class="kw">map</span>(cm_list, <span class="st">&quot;선거구&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>flatten <span class="op">%&gt;%</span><span class="st"> </span>unlist <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.character</span>()</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true"></a>party_v &lt;-<span class="st"> </span><span class="kw">map</span>(cm_list, <span class="st">&quot;소속정당&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>flatten <span class="op">%&gt;%</span><span class="st"> </span>unlist <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.character</span>()</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true"></a>geo_v &lt;-<span class="st"> </span><span class="kw">map</span>(cm_list, <span class="st">&quot;관할구역&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>flatten <span class="op">%&gt;%</span><span class="st"> </span>unlist <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.character</span>()</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true"></a>num_v &lt;-<span class="st"> </span><span class="kw">map</span>(cm_list, <span class="st">&quot;선수&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>flatten <span class="op">%&gt;%</span><span class="st"> </span>unlist <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.character</span>()</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true"></a></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true"></a>cm_df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(이름=name_v, </span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true"></a>           선거구=precinct_v,</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true"></a>           정당=party_v,</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true"></a>           지역=geo_v,</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true"></a>           선수=num_v) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true"></a><span class="st">  </span><span class="kw">separate</span>(이름, <span class="dt">into=</span><span class="kw">c</span>(<span class="st">&quot;한글명&quot;</span>, <span class="st">&quot;한자&quot;</span>), <span class="dt">sep=</span><span class="st">&quot;</span><span class="ch">\\</span><span class="st">(&quot;</span> ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true"></a><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(한자))</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true"></a></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true"></a>DT<span class="op">::</span><span class="kw">datatable</span>(cm_df)</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true"></a></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true"></a>cm_df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">write_rds</span>(<span class="st">&quot;data/cm_df.rds&quot;</span>)</span></code></pre></div>
<h2 id="dp-congressman-youtube-workflow-crawling-site">국회의원 사이트 정보</h2>
<p>국회의원 명단이 준비되었다면 다음으로 <strong>사이트</strong>에서 유튜브 주소를 가져온다. 이를 위해서 국회의원 한명을 대상으로 <strong>사이트</strong> 정보를 제대로 가져오는지 준비한다.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a><span class="co"># 1. 데이터: 네이버 인물정보 -----</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true"></a><span class="co">## 1.1. 네이버 주소 -----</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true"></a>url &lt;-<span class="st"> &quot;https://search.naver.com/search.naver?where=nexearch&amp;sm=top_hty&amp;fbm=1&amp;ie=utf8&amp;query=&quot;</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true"></a>people_name &lt;-<span class="st"> &quot;김병욱&quot;</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true"></a>naver_url &lt;-<span class="st"> </span><span class="kw">glue</span>({url}, {people_name})</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true"></a><span class="co">## 1.2. 네이버 인물정보 긁어오기 -----</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true"></a><span class="co">### 인물정보 </span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true"></a>key &lt;-<span class="st"> </span><span class="kw">read_html</span>(naver_url) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true"></a><span class="st">        </span><span class="kw">html_node</span>(<span class="dt">xpath =</span> <span class="st">&#39;//*[@id=&quot;people_info_z&quot;]/div[2]/div/dl&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true"></a><span class="st">        </span><span class="kw">html_nodes</span>(<span class="st">&#39;dt&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true"></a><span class="st">        </span><span class="kw">html_text</span>()</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true"></a>        </span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true"></a>value &lt;-<span class="st"> </span><span class="kw">read_html</span>(naver_url) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true"></a><span class="st">  </span><span class="kw">html_node</span>(<span class="dt">xpath =</span> <span class="st">&#39;//*[@id=&quot;people_info_z&quot;]/div[2]/div/dl&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true"></a><span class="st">  </span><span class="kw">html_nodes</span>(<span class="st">&#39;dd&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true"></a><span class="st">  </span><span class="kw">html_text</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true"></a><span class="st">  </span>.[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true"></a></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true"></a>site &lt;-<span class="st"> </span><span class="kw">read_html</span>(naver_url) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true"></a><span class="st">  </span><span class="kw">html_node</span>(<span class="dt">xpath =</span> <span class="st">&#39;//*[@id=&quot;people_info_z&quot;]/div[2]/div/dl&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true"></a><span class="st">  </span><span class="kw">html_nodes</span>(<span class="st">&#39;dd&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true"></a><span class="st">  </span><span class="kw">html_nodes</span>(<span class="st">&quot;a&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true"></a><span class="st">  </span><span class="kw">html_attr</span>(<span class="st">&quot;href&quot;</span>)</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true"></a></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true"></a>p_info_df &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">key =</span> key,</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true"></a>                    <span class="dt">value =</span> value) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true"></a><span class="st">  </span><span class="kw">spread</span>(key, value) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">이름</span><span class="st">`</span> =<span class="st"> &quot;김병욱&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">site =</span> <span class="kw">list</span>(site))</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true"></a></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true"></a>DT<span class="op">::</span><span class="kw">datatable</span>(p_info_df)</span></code></pre></div>
<p>특정 국회의원 <strong>사이트</strong>를 받아오는 스크립트를 함수로 작성한다.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a><span class="co"># 1. 네이버 인물정보 함수 -----</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a><span class="co">## 1.1. 이름 </span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true"></a>people_info &lt;-<span class="st"> </span><span class="cf">function</span>(people_name) {</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true"></a>  <span class="co">## 1.1. 네이버 주소 -----</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true"></a>  url &lt;-<span class="st"> &quot;https://search.naver.com/search.naver?where=nexearch&amp;sm=top_hty&amp;fbm=1&amp;ie=utf8&amp;query=&quot;</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true"></a>  </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true"></a>  naver_url &lt;-<span class="st"> </span><span class="kw">glue</span>({url}, {people_name})</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true"></a>  </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true"></a>  <span class="co">## 1.2. 네이버 인물정보 긁어오기 -----</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true"></a>  key &lt;-<span class="st"> </span><span class="kw">read_html</span>(naver_url) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true"></a><span class="st">          </span><span class="kw">html_node</span>(<span class="dt">xpath =</span> <span class="st">&#39;//*[@id=&quot;people_info_z&quot;]/div[2]/div/dl&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true"></a><span class="st">          </span><span class="kw">html_nodes</span>(<span class="st">&#39;dt&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true"></a><span class="st">          </span><span class="kw">html_text</span>()</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true"></a>          </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true"></a>  </span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true"></a>  value &lt;-<span class="st"> </span><span class="kw">read_html</span>(naver_url) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true"></a><span class="st">    </span><span class="kw">html_node</span>(<span class="dt">xpath =</span> <span class="st">&#39;//*[@id=&quot;people_info_z&quot;]/div[2]/div/dl&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true"></a><span class="st">    </span><span class="kw">html_nodes</span>(<span class="st">&#39;dd&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true"></a><span class="st">    </span><span class="kw">html_text</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true"></a><span class="st">    </span>.[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true"></a>  </span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true"></a>  site &lt;-<span class="st"> </span><span class="kw">read_html</span>(naver_url) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true"></a><span class="st">    </span><span class="kw">html_node</span>(<span class="dt">xpath =</span> <span class="st">&#39;//*[@id=&quot;people_info_z&quot;]/div[2]/div/dl&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true"></a><span class="st">    </span><span class="kw">html_nodes</span>(<span class="st">&#39;dd&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true"></a><span class="st">    </span><span class="kw">html_nodes</span>(<span class="st">&quot;a&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true"></a><span class="st">    </span><span class="kw">html_attr</span>(<span class="st">&quot;href&quot;</span>)</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true"></a>  </span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true"></a>  p_info_df &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">key =</span> key,</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true"></a>                      <span class="dt">value =</span> value) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true"></a><span class="st">    </span><span class="kw">spread</span>(key, value) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">이름</span><span class="st">`</span> =<span class="st"> </span>people_name) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">site =</span> <span class="kw">list</span>(site))</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true"></a>  </span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true"></a>  <span class="kw">return</span>(p_info_df)</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true"></a>}</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true"></a></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true"></a><span class="co">## 1.2. 경합 </span></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true"></a>people_url_info &lt;-<span class="st"> </span><span class="cf">function</span>(url, people_name) {</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true"></a>  <span class="co">## 1.1. 네이버 주소 -----</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true"></a>  naver_url &lt;-<span class="st"> </span><span class="kw">glue</span>(url, people_name)</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true"></a>  </span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true"></a>  <span class="co">## 1.2. 네이버 인물정보 긁어오기 -----</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true"></a>  <span class="co">### 인물정보 </span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true"></a>  key &lt;-<span class="st"> </span><span class="kw">read_html</span>(naver_url) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true"></a><span class="st">    </span><span class="kw">html_node</span>(<span class="dt">xpath =</span> <span class="st">&#39;//*[@id=&quot;people_info_z&quot;]/div[2]/div/dl&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true"></a><span class="st">    </span><span class="kw">html_nodes</span>(<span class="st">&#39;dt&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true"></a><span class="st">    </span><span class="kw">html_text</span>()</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true"></a>  </span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true"></a>  value &lt;-<span class="st"> </span><span class="kw">read_html</span>(naver_url) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true"></a><span class="st">    </span><span class="kw">html_node</span>(<span class="dt">xpath =</span> <span class="st">&#39;//*[@id=&quot;people_info_z&quot;]/div[2]/div/dl&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true"></a><span class="st">    </span><span class="kw">html_nodes</span>(<span class="st">&#39;dd&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true"></a><span class="st">    </span><span class="kw">html_text</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true"></a><span class="st">    </span>.[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true"></a>  </span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true"></a>  site &lt;-<span class="st"> </span><span class="kw">read_html</span>(naver_url) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true"></a><span class="st">    </span><span class="kw">html_node</span>(<span class="dt">xpath =</span> <span class="st">&#39;//*[@id=&quot;people_info_z&quot;]/div[2]/div/dl&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true"></a><span class="st">    </span><span class="kw">html_nodes</span>(<span class="st">&#39;dd&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true"></a><span class="st">    </span><span class="kw">html_nodes</span>(<span class="st">&quot;a&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true"></a><span class="st">    </span><span class="kw">html_attr</span>(<span class="st">&quot;href&quot;</span>)</span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true"></a>  </span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true"></a>  p_info_df &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">key =</span> key,</span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true"></a>                      <span class="dt">value =</span> value) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true"></a><span class="st">    </span><span class="kw">spread</span>(key, value) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">이름</span><span class="st">`</span> =<span class="st"> </span>people_name) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">site =</span> <span class="kw">list</span>(site))</span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true"></a>  </span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true"></a>  <span class="kw">return</span>(p_info_df)</span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true"></a>}</span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true"></a></span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true"></a></span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true"></a><span class="co"># 2. 네이버 인물 데이터 -----</span></span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true"></a></span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true"></a><span class="kw">people_info</span>(<span class="st">&quot;김병욱&quot;</span>)</span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true"></a></span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true"></a><span class="kw">people_url_info</span>(<span class="st">&quot;https://search.naver.com/search.naver?where=nexearch&amp;sm=tab_etc&amp;mra=bjky&amp;pkid=1&amp;os=99291&amp;query=&quot;</span>, <span class="st">&quot;진영&quot;</span>)</span></code></pre></div>
<p>특정 국회의원 <strong>사이트</strong>를 받아오는 스크립트를 함수로 작성한 것을 활용하는 단계로 넘어간다. 앞서 입수한 국회의원 명단을 넣어 데이터를 긁어온다.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a><span class="co"># 2. 국회의원 명단 -----</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a>cm_name_v &lt;-<span class="st"> </span>cm_df<span class="op">$</span>한글명</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true"></a><span class="co"># 3. 네이버 국회의원 정보 -----</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true"></a>np_list &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="dt">length=</span><span class="kw">length</span>(cm_name_v))</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(cm_name_v)) {</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true"></a>  <span class="kw">tryCatch</span>({</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true"></a>    np_list[[i]] &lt;-<span class="st"> </span><span class="kw">people_info</span>(cm_name_v[i])</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true"></a>    <span class="co"># cat(i, &quot;: &quot;, cm_name_v[i], &quot;\n&quot;)</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true"></a>  }, <span class="dt">error=</span><span class="cf">function</span>(e){})</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true"></a>}</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true"></a><span class="kw">names</span>(np_list) &lt;-<span class="st"> </span>cm_name_v</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true"></a><span class="co">## 3.1. 네이버 국회의원 정보 보완 -----</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true"></a><span class="co">### 결측값 국회의원 </span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true"></a>np_missing_v &lt;-<span class="st"> </span><span class="kw">map_int</span>(np_list, length)</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true"></a>  np_missing_v &lt;-<span class="st"> </span>np_missing_v[np_missing_v <span class="op">==</span><span class="st"> </span><span class="dv">0</span>]</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true"></a></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true"></a>np_missing_df &lt;-<span class="st"> </span><span class="kw">tribble</span>(</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true"></a>  <span class="op">~</span><span class="st">&quot;이름&quot;</span>, <span class="op">~</span><span class="st">&quot;url&quot;</span>,</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true"></a>  <span class="st">&quot;진영&quot;</span>,   <span class="st">&quot;https://search.naver.com/search.naver?where=nexearch&amp;sm=tab_etc&amp;mra=bjky&amp;pkid=1&amp;os=99291&amp;query=&quot;</span>,</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true"></a>  <span class="st">&quot;김영호&quot;</span>, <span class="st">&quot;https://search.naver.com/search.naver?where=nexearch&amp;sm=tab_etc&amp;mra=bjky&amp;pkid=1&amp;os=145649&amp;query=&quot;</span>,</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true"></a>  <span class="st">&quot;김성태&quot;</span>, <span class="st">&quot;https://search.naver.com/search.naver?where=nexearch&amp;sm=tab_etc&amp;mra=bjky&amp;pkid=1&amp;os=154130&amp;query=&quot;</span>,</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true"></a>  <span class="st">&quot;이훈&quot;</span>,   <span class="st">&quot;https://search.naver.com/search.naver?where=nexearch&amp;sm=tab_etc&amp;mra=bjky&amp;pkid=1&amp;os=285873&amp;query=&quot;</span>,</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true"></a>  <span class="st">&quot;최명길&quot;</span>, <span class="st">&quot;https://search.naver.com/search.naver?where=nexearch&amp;sm=tab_etc&amp;mra=bjky&amp;pkid=1&amp;os=96414&amp;query=&quot;</span>,</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true"></a>  <span class="st">&quot;김정훈&quot;</span>, <span class="st">&quot;https://search.naver.com/search.naver?where=nexearch&amp;sm=tab_etc&amp;mra=bjky&amp;pkid=1&amp;os=99295&amp;query=&quot;</span>,</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true"></a>  <span class="st">&quot;안상수&quot;</span>, <span class="st">&quot;https://search.naver.com/search.naver?where=nexearch&amp;sm=tab_etc&amp;mra=bjky&amp;pkid=1&amp;os=95772&amp;query=&quot;</span>,</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true"></a>  <span class="st">&quot;윤상현&quot;</span>, <span class="st">&quot;https://search.naver.com/search.naver?where=nexearch&amp;sm=tab_etc&amp;mra=bjky&amp;pkid=1&amp;os=140452&amp;query=&quot;</span>,</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true"></a>  <span class="st">&quot;김경진&quot;</span>, <span class="st">&quot;https://search.naver.com/search.naver?where=nexearch&amp;sm=tab_etc&amp;mra=bjky&amp;pkid=1&amp;os=152472&amp;query=&quot;</span>,</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true"></a>  <span class="st">&quot;최경환&quot;</span>, <span class="st">&quot;https://search.naver.com/search.naver?where=nexearch&amp;sm=tab_etc&amp;mra=bjky&amp;pkid=1&amp;os=99359&amp;query=&quot;</span>,</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true"></a>  <span class="st">&quot;이장우&quot;</span>, <span class="st">&quot;https://search.naver.com/search.naver?where=nexearch&amp;sm=tab_etc&amp;mra=bjky&amp;pkid=1&amp;os=125793&amp;query=&quot;</span>,</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true"></a>  <span class="st">&quot;이상민&quot;</span>, <span class="st">&quot;https://search.naver.com/search.naver?where=nexearch&amp;sm=tab_etc&amp;mra=bjky&amp;pkid=1&amp;os=99176&amp;query=&quot;</span>,</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true"></a>  <span class="st">&quot;김영진&quot;</span>, <span class="st">&quot;https://search.naver.com/search.naver?where=nexearch&amp;sm=tab_etc&amp;mra=bjky&amp;pkid=1&amp;os=311980&amp;query=&quot;</span>,</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true"></a>  <span class="st">&quot;김진표&quot;</span>, <span class="st">&quot;https://search.naver.com/search.naver?where=nexearch&amp;sm=tab_etc&amp;mra=bjky&amp;pkid=1&amp;os=97441&amp;query=&quot;</span>,</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true"></a>  <span class="st">&quot;김상희&quot;</span>, <span class="st">&quot;https://search.naver.com/search.naver?where=nexearch&amp;sm=tab_etc&amp;mra=bjky&amp;pkid=1&amp;os=151651&amp;query=&quot;</span>,</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true"></a>  <span class="st">&quot;김성원&quot;</span>, <span class="st">&quot;https://search.naver.com/search.naver?where=nexearch&amp;sm=tab_etc&amp;mra=bjky&amp;pkid=1&amp;os=314223&amp;query=&quot;</span>,</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true"></a>  <span class="st">&quot;김철민&quot;</span>, <span class="st">&quot;https://search.naver.com/search.naver?where=nexearch&amp;sm=tab_etc&amp;mra=bjky&amp;pkid=1&amp;os=178883&amp;query=&quot;</span>,</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true"></a>  <span class="st">&quot;조정식&quot;</span>, <span class="st">&quot;https://search.naver.com/search.naver?where=nexearch&amp;sm=tab_etc&amp;mra=bjky&amp;pkid=1&amp;os=99207&amp;query=&quot;</span>,</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true"></a>  <span class="st">&quot;김정우&quot;</span>, <span class="st">&quot;https://search.naver.com/search.naver?where=nexearch&amp;sm=tab_etc&amp;mra=bjky&amp;pkid=1&amp;os=3143802&amp;query=&quot;</span>,</span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true"></a>  <span class="st">&quot;이현재&quot;</span>, <span class="st">&quot;https://search.naver.com/search.naver?where=nexearch&amp;sm=tab_etc&amp;mra=bjky&amp;pkid=1&amp;os=122137&amp;query=&quot;</span>,</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true"></a>  <span class="st">&quot;정성호&quot;</span>, <span class="st">&quot;https://search.naver.com/search.naver?where=nexearch&amp;sm=tab_etc&amp;mra=bjky&amp;pkid=1&amp;os=99194&amp;query=&quot;</span>,</span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true"></a>  <span class="st">&quot;김종민&quot;</span>, <span class="st">&quot;https://search.naver.com/search.naver?where=nexearch&amp;sm=tab_etc&amp;mra=bjky&amp;pkid=1&amp;os=113207&amp;query=&quot;</span>,</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true"></a>  <span class="st">&quot;이정현&quot;</span>, <span class="st">&quot;https://search.naver.com/search.naver?where=nexearch&amp;sm=tab_etc&amp;mra=bjky&amp;pkid=1&amp;os=154105&amp;query=&quot;</span>,</span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true"></a>  <span class="st">&quot;박준영&quot;</span>, <span class="st">&quot;https://search.naver.com/search.naver?where=nexearch&amp;sm=tab_etc&amp;mra=bjky&amp;pkid=1&amp;os=100016&amp;query=&quot;</span>,</span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true"></a>  <span class="st">&quot;이철우&quot;</span>, <span class="st">&quot;https://search.naver.com/search.naver?where=nexearch&amp;sm=tab_etc&amp;mra=bjky&amp;pkid=1&amp;os=123634&amp;query=&quot;</span>,</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true"></a>  <span class="st">&quot;김재원&quot;</span>, <span class="st">&quot;https://search.naver.com/search.naver?where=nexearch&amp;sm=tab_etc&amp;mra=bjky&amp;pkid=1&amp;os=99363&amp;query=&quot;</span>,</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true"></a>  <span class="st">&quot;최경환&quot;</span>, <span class="st">&quot;https://search.naver.com/search.naver?where=nexearch&amp;sm=tab_etc&amp;mra=bjky&amp;pkid=1&amp;os=248894&amp;query=&quot;</span>,</span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true"></a>  <span class="st">&quot;이주영&quot;</span>, <span class="st">&quot;https://search.naver.com/search.naver?where=nexearch&amp;sm=tab_etc&amp;mra=bjky&amp;pkid=1&amp;os=126184&amp;query=&quot;</span>,</span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true"></a>  <span class="st">&quot;김재경&quot;</span>, <span class="st">&quot;https://search.naver.com/search.naver?where=nexearch&amp;sm=tab_etc&amp;mra=bjky&amp;pkid=1&amp;os=99387&amp;query=&quot;</span>,</span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true"></a>  <span class="st">&quot;엄용수&quot;</span>, <span class="st">&quot;https://search.naver.com/search.naver?where=nexearch&amp;sm=tab_etc&amp;mra=bjky&amp;pkid=1&amp;os=125837&amp;query=&quot;</span></span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true"></a>)</span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true"></a></span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true"></a><span class="co">### 결측값 국회의원 데이터 가져오기</span></span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true"></a>np_missing_list &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="dt">length=</span><span class="kw">nrow</span>(np_missing_df))</span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true"></a></span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(np_missing_df)) {</span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true"></a>  <span class="kw">tryCatch</span>({</span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true"></a>    np_missing_list[[i]] &lt;-<span class="st"> </span><span class="kw">people_url_info</span>(<span class="kw">as.character</span>(np_missing_df[i,<span class="dv">2</span>]), <span class="kw">as.character</span>(np_missing_df[i,<span class="dv">1</span>]))</span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true"></a>    <span class="co"># cat(i, &quot;: &quot;, as.character(np_missing_df[i,1]), &quot;\n&quot;)</span></span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true"></a>  }, <span class="dt">error=</span><span class="cf">function</span>(e){})</span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true"></a>}</span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true"></a></span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true"></a><span class="kw">names</span>(np_missing_list) &lt;-<span class="st"> </span>np_missing_df<span class="op">$</span>이름</span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true"></a></span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true"></a>listviewer<span class="op">::</span><span class="kw">jsonedit</span>(np_missing_list)</span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true"></a></span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true"></a><span class="co">## 3.2. 네이버 국회의원 결합 -----</span></span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true"></a></span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true"></a>np_comp_list &lt;-<span class="st"> </span><span class="kw">append</span>(np_list, np_missing_list)</span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true"></a></span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true"></a>np_comp_list &lt;-<span class="st"> </span>plyr<span class="op">::</span><span class="kw">compact</span>(np_comp_list) <span class="co"># NULL 제거</span></span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true"></a></span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true"></a>listviewer<span class="op">::</span><span class="kw">jsonedit</span>(np_comp_list)</span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true"></a></span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true"></a><span class="co">## 3.3. 네이버 국회의원 데이터 저장 -----</span></span>
<span id="cb4-78"><a href="#cb4-78" aria-hidden="true"></a>np_comp_list <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">write_rds</span>(<span class="st">&quot;data/np_comp_list.rds&quot;</span>)</span></code></pre></div>
<h1 id="dp-congressman-youtube-workflow-clean">데이터 정제</h1>
<p>긁어온 데이터를 SNS별로 정당별로 정제하여 데이터프레임으로 깔끔하게 정제해 둔다.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a>np_comp_dat &lt;-<span class="st"> </span><span class="kw">tibble</span>(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true"></a>  <span class="dt">name =</span> <span class="kw">names</span>(np_comp_list),</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true"></a>  <span class="dt">site =</span> <span class="kw">map</span>(np_comp_list, <span class="st">&quot;site&quot;</span>))</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true"></a>np_comp_dat &lt;-<span class="st"> </span>np_comp_dat <span class="op">%&gt;%</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">num_url =</span> <span class="kw">map_int</span>(site, length)) <span class="op">%&gt;%</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true"></a><span class="st">  </span><span class="kw">filter</span>(num_url <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true"></a><span class="st">  </span><span class="kw">unnest</span>(site) <span class="op">%&gt;%</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true"></a><span class="st">  </span><span class="kw">unnest</span>(site) <span class="op">%&gt;%</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true"></a><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">str_detect</span>(site, <span class="st">&quot;^?where=|https://people.search.naver.com/&quot;</span>))</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true"></a>np_comp_df &lt;-<span class="st"> </span>np_comp_dat <span class="op">%&gt;%</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sns =</span> <span class="kw">case_when</span>(<span class="kw">str_detect</span>(site, <span class="st">&quot;blog.naver.com/|^http://blog&quot;</span>) <span class="op">~</span><span class="st"> &quot;네이버 블로그&quot;</span>,</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true"></a>                         <span class="kw">str_detect</span>(site, <span class="st">&quot;www.facebook.com&quot;</span>) <span class="op">~</span><span class="st"> &quot;페이스북&quot;</span>,</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true"></a>                         <span class="kw">str_detect</span>(site, <span class="st">&quot;twitter.com&quot;</span>) <span class="op">~</span><span class="st"> &quot;트위터&quot;</span>,</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true"></a>                         <span class="kw">str_detect</span>(site, <span class="st">&quot;youtube.com&quot;</span>) <span class="op">~</span><span class="st"> &quot;유튜브&quot;</span>,</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true"></a>                         <span class="kw">str_detect</span>(site, <span class="st">&quot;instagram.com/&quot;</span>) <span class="op">~</span><span class="st"> &quot;인스타그램&quot;</span>,</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true"></a>                         <span class="kw">str_detect</span>(site, <span class="st">&quot;m.post&quot;</span>) <span class="op">~</span><span class="st"> &quot;네이버 포스트&quot;</span>,</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true"></a>                         <span class="kw">str_detect</span>(site, <span class="st">&quot;blog.daum.net&quot;</span>) <span class="op">~</span><span class="st"> &quot;다음 블로그&quot;</span>,</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true"></a>                         <span class="kw">str_detect</span>(site, <span class="st">&quot;band.us&quot;</span>) <span class="op">~</span><span class="st"> &quot;밴드&quot;</span>,</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true"></a>                         <span class="kw">str_detect</span>(site, <span class="st">&quot;cafe.daum.net&quot;</span>) <span class="op">~</span><span class="st"> &quot;다음 카페&quot;</span>,</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true"></a>                         <span class="kw">str_detect</span>(site, <span class="st">&quot;cafe.naver&quot;</span>) <span class="op">~</span><span class="st"> &quot;네이버 카페&quot;</span>,</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true"></a>                         <span class="kw">str_detect</span>(site, <span class="st">&quot;kakao&quot;</span>) <span class="op">~</span><span class="st"> &quot;카카오&quot;</span>,</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true"></a>                         <span class="kw">str_detect</span>(site, <span class="st">&quot;tistory&quot;</span>) <span class="op">~</span><span class="st"> &quot;티스토리&quot;</span>,</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true"></a>                         <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;공식사이트&quot;</span>))</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true"></a></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true"></a>np_comp_df &lt;-<span class="st"> </span><span class="kw">left_join</span>(np_comp_df, cm_df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(한글명,정당), <span class="dt">by=</span><span class="kw">c</span>(<span class="st">&quot;name&quot;</span> =<span class="st"> &quot;한글명&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">current_party =</span> <span class="kw">str_extract</span>(정당, <span class="st">&quot;(국민의당|무소속|더불어민주당|바른미래당|민중당|자유한국당|민주평화당|대한애국당|정의당|새누리당)$&quot;</span>))</span></code></pre></div>
<h1 id="dp-congressman-youtube-workflow-sns">SNS 분석</h1>
<h2 id="dp-congressman-youtube-workflow-sns-party">정당별 SNS 활용</h2>
<h3 id="dp-congressman-youtube-workflow-sns-party-congressman">국회의원이 선호하는 SNS</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="kw">library</span>(DT)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true"></a>np_comp_df <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">count</span>(sns, <span class="dt">sort=</span><span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pcnt =</span> n<span class="op">/</span><span class="kw">sum</span>(n)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true"></a><span class="st">  </span>DT<span class="op">::</span><span class="kw">datatable</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true"></a><span class="st">    </span>DT<span class="op">::</span><span class="kw">formatPercentage</span>(<span class="st">&quot;pcnt&quot;</span>, <span class="dt">digits=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="figure/dp-congressman-sns-eda-party-congressman-1.png" title="plot of chunk dp-congressman-sns-eda-party-congressman" alt="plot of chunk dp-congressman-sns-eda-party-congressman" style="display: block; margin: auto;" /></p>
<h3 id="dp-congressman-sns-party-congressman">정당별 선호하는 SNS</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a>np_comp_df <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">filter</span>(sns <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;공식사이트&quot;</span>, <span class="st">&quot;네이버 블로그&quot;</span>, <span class="st">&quot;유튜브&quot;</span>, <span class="st">&quot;인스타그램&quot;</span>, <span class="st">&quot;트위터&quot;</span>, <span class="st">&quot;페이스북&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">filter</span>(current_party <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;더불어민주당&quot;</span>, <span class="st">&quot;자유한국당&quot;</span>, <span class="st">&quot;바른미래당&quot;</span>, <span class="st">&quot;민주평화당&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">count</span>(sns, current_party, <span class="dt">sort=</span><span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sns =</span> <span class="kw">factor</span>(sns, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;공식사이트&quot;</span>, <span class="st">&quot;페이스북&quot;</span>, <span class="st">&quot;네이버 블로그&quot;</span>, <span class="st">&quot;유튜브&quot;</span>, <span class="st">&quot;인스타그램&quot;</span>, <span class="st">&quot;트위터&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">current_party =</span> <span class="kw">factor</span>(current_party, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;더불어민주당&quot;</span>, <span class="st">&quot;자유한국당&quot;</span>, <span class="st">&quot;바른미래당&quot;</span>, <span class="st">&quot;민주평화당&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>current_party, <span class="dt">y=</span>n, <span class="dt">fill=</span>sns)) <span class="op">+</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_col</span>(<span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="op">+</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true"></a><span class="st">    </span><span class="kw">coord_flip</span>() <span class="op">+</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;&quot;</span>, <span class="dt">y=</span><span class="st">&quot;&quot;</span>, <span class="dt">fill=</span><span class="st">&quot;SNS&quot;</span>) <span class="op">+</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_minimal</span>(<span class="dt">base_family =</span> <span class="st">&quot;NanumGothic&quot;</span>)</span></code></pre></div>
<p><img src="figure/dp-congressman-sns-eda-party-congressman-2-1.png" title="plot of chunk dp-congressman-sns-eda-party-congressman-2" alt="plot of chunk dp-congressman-sns-eda-party-congressman-2" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a>np_comp_df <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">filter</span>(sns <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;공식사이트&quot;</span>, <span class="st">&quot;네이버 블로그&quot;</span>, <span class="st">&quot;유튜브&quot;</span>, <span class="st">&quot;인스타그램&quot;</span>, <span class="st">&quot;트위터&quot;</span>, <span class="st">&quot;페이스북&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">filter</span>(current_party <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;더불어민주당&quot;</span>, <span class="st">&quot;자유한국당&quot;</span>, <span class="st">&quot;바른미래당&quot;</span>, <span class="st">&quot;민주평화당&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">count</span>(sns, current_party, <span class="dt">sort=</span><span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">current_party =</span> <span class="kw">factor</span>(current_party, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;더불어민주당&quot;</span>, <span class="st">&quot;자유한국당&quot;</span>, <span class="st">&quot;바른미래당&quot;</span>, <span class="st">&quot;민주평화당&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>sns, <span class="dt">y=</span>n, <span class="dt">fill=</span>current_party)) <span class="op">+</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_col</span>(<span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="op">+</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true"></a><span class="st">    </span><span class="kw">coord_flip</span>() <span class="op">+</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;&quot;</span>, <span class="dt">y=</span><span class="st">&quot;&quot;</span>, <span class="dt">fill=</span><span class="st">&quot;정당&quot;</span>) <span class="op">+</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_minimal</span>(<span class="dt">base_family =</span> <span class="st">&quot;NanumGothic&quot;</span>) <span class="op">+</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&quot;더불어민주당&quot;</span>=<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;민주평화당&quot;</span>=<span class="st">&quot;green&quot;</span>, <span class="st">&quot;바른미래당&quot;</span>=<span class="st">&quot;cyan&quot;</span>, <span class="st">&quot;자유한국당&quot;</span>=<span class="st">&quot;red&quot;</span>))</span></code></pre></div>
<p><img src="figure/dp-congressman-sns-eda-party-congressman-2-2.png" title="plot of chunk dp-congressman-sns-eda-party-congressman-2" alt="plot of chunk dp-congressman-sns-eda-party-congressman-2" style="display: block; margin: auto;" /></p>
<h1 id="dp-congressman-sns-youtube">유튜브 트래픽 <a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></h1>
<h2 id="dp-congressman-sns-youtube-channel-id">유튜브 채널ID 알아내기</h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true"></a>np_comp_list  &lt;-<span class="st"> </span><span class="kw">read_rds</span>(<span class="st">&quot;data/np_comp_list.rds&quot;</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true"></a>np_comp_df  &lt;-<span class="st"> </span><span class="kw">read_rds</span>(<span class="st">&quot;data/np_comp_df&quot;</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true"></a>np_comp_yt_df &lt;-<span class="st"> </span>np_comp_df <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true"></a><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(site, <span class="st">&quot;youtube&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true"></a><span class="st">  </span><span class="kw">select</span>(name, site) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">channel =</span> <span class="kw">str_replace</span>(site, <span class="st">&quot;^(http|https)://www.youtube.com/&quot;</span>, <span class="st">&quot;&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">channel_id =</span> <span class="kw">case_when</span>(</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true"></a>    <span class="kw">str_detect</span>(channel, <span class="st">&quot;^(c/|user/)&quot;</span>) <span class="op">~</span><span class="st"> </span><span class="kw">str_replace</span>(channel, <span class="st">&quot;c/|user/&quot;</span>, <span class="st">&quot;&quot;</span>),</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true"></a>    <span class="kw">str_detect</span>(channel, <span class="st">&quot;^channel/&quot;</span>) <span class="op">~</span><span class="st"> </span><span class="kw">str_replace</span>(channel, <span class="st">&quot;channel/&quot;</span>, <span class="st">&quot;&quot;</span>),</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true"></a>    <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span>channel)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">channel_len =</span> <span class="kw">str_length</span>(channel_id)) </span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true"></a></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true"></a>user_v &lt;-<span class="st"> </span>np_comp_yt_df <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true"></a><span class="st">  </span><span class="kw">filter</span>(channel_len <span class="op">&lt;</span><span class="st"> </span><span class="dv">20</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true"></a><span class="st">  </span><span class="kw">pull</span>(channel_id)</span></code></pre></div>
<h2 id="dp-congressman-sns-youtube-channel-id-convert">유튜브 ID를 채널로 바꾸기</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true"></a><span class="kw">library</span>(RSelenium)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true"></a><span class="co"># 1. 데이터 ----</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true"></a>rem_driver &lt;-<span class="st"> </span><span class="kw">rsDriver</span>(<span class="dt">browser=</span><span class="st">&quot;chrome&quot;</span>, <span class="dt">port=</span>77L)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true"></a>remdrv_client &lt;-<span class="st"> </span>rem_driver[[<span class="st">&quot;client&quot;</span>]]</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true"></a>remdrv_client<span class="op">$</span><span class="kw">navigate</span>(<span class="st">&quot;http://johnnythetank.github.io/youtube-channel-name-converter/&quot;</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true"></a>yt_web_element &lt;-<span class="st"> </span>remdrv_client<span class="op">$</span><span class="kw">findElement</span>(<span class="st">&#39;class&#39;</span>, <span class="st">&#39;form-control&#39;</span>)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true"></a>yt_web_element<span class="op">$</span><span class="kw">clearElement</span>()</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true"></a>yt_web_element<span class="op">$</span><span class="kw">sendKeysToElement</span>(<span class="kw">list</span>(<span class="st">&#39;maumgil88&#39;</span>, <span class="dt">key=</span><span class="st">&#39;enter&#39;</span>))</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true"></a>yt_channel_web_element &lt;-<span class="st"> </span>remdrv_client<span class="op">$</span><span class="kw">findElement</span>(<span class="st">&#39;class&#39;</span>, <span class="st">&#39;ng-binding&#39;</span>)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true"></a></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true"></a>yt_channel_web_element<span class="op">$</span><span class="kw">getElementText</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unlist</span>()</span></code></pre></div>
<p>다음 코드는 동작을 하지 않네요… ㅎㅎ</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true"></a>yt_web_element &lt;-<span class="st"> </span>remdrv_client<span class="op">$</span><span class="kw">findElement</span>(<span class="st">&#39;class&#39;</span>, <span class="st">&#39;form-control&#39;</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true"></a>query_channel_id &lt;-<span class="st"> </span><span class="cf">function</span>(yt_name) {</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true"></a>  </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true"></a>  <span class="kw">tryCatch</span>({</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true"></a>     </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true"></a>    yt_web_element<span class="op">$</span><span class="kw">clearElement</span>()</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true"></a>    yt_web_element<span class="op">$</span><span class="kw">sendKeysToElement</span>(<span class="kw">list</span>(yt_name, <span class="dt">key=</span><span class="st">&#39;enter&#39;</span>))</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true"></a>    yt_channel_web_element &lt;-<span class="st"> </span>remdrv_client<span class="op">$</span><span class="kw">findElement</span>(<span class="st">&#39;class&#39;</span>, <span class="st">&#39;ng-binding&#39;</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true"></a>    channel_id &lt;-<span class="st"> </span>yt_channel_web_element<span class="op">$</span><span class="kw">getElementText</span>()</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true"></a></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true"></a>  }, <span class="dt">warning =</span> <span class="cf">function</span>(yt_name) {</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true"></a>    channel_id &lt;-<span class="st"> </span>yt_name</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true"></a>  }, <span class="dt">error =</span> <span class="cf">function</span>(yt_name) {</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true"></a>    channel_id &lt;-<span class="st"> </span>yt_name</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true"></a>  })</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true"></a>  <span class="kw">return</span>(channel_id)</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true"></a>}</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true"></a></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true"></a><span class="kw">query_channel_id</span>(<span class="st">&#39;2haechan&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true"></a><span class="kw">library</span>(tuber) <span class="co"># devtools::install_github(&quot;soodoku/tuber&quot;, build_vignettes = TRUE)</span></span></code></pre></div>
<pre><code>Error in library(tuber): there is no package called &#39;tuber&#39;</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true"></a><span class="kw">yt_oauth</span>(yt_app_id, yt_app_pw)</span></code></pre></div>
<pre><code>Error in yt_oauth(yt_app_id, yt_app_pw): could not find function &quot;yt_oauth&quot;</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true"></a><span class="kw">get_stats</span>(<span class="dt">video_id =</span> <span class="st">&quot;peLTHX-rBxM&quot;</span>)</span></code></pre></div>
<pre><code>Error in get_stats(video_id = &quot;peLTHX-rBxM&quot;): could not find function &quot;get_stats&quot;</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true"></a>channel_id &lt;-<span class="st"> </span>np_comp_yt_df <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">filter</span>(channel_len <span class="op">==</span><span class="st"> </span><span class="dv">24</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">pull</span>(channel_id)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true"></a>yt_congress_stat &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true"></a>  </span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true"></a><span class="cf">for</span>(channel <span class="cf">in</span> channel_id) {</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true"></a>  </span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true"></a>  <span class="kw">print</span>(channel)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true"></a>  yt_congress_stat[[channel]] &lt;-<span class="st">  </span><span class="kw">get_channel_stats</span>(<span class="dt">channel_id=</span>channel)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true"></a>}</span></code></pre></div>
<pre><code>[1] &quot;UCeKt3AtHLhkL1sSZrxpYi8Q&quot;</code></pre>
<pre><code>Error in get_channel_stats(channel_id = channel): could not find function &quot;get_channel_stats&quot;</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true"></a>listviewer<span class="op">::</span><span class="kw">jsonedit</span>(yt_congress_stat)</span></code></pre></div>
<p><img src="figure/dp-congressman-sns-yt-crawl-1.png" title="plot of chunk dp-congressman-sns-yt-crawl" alt="plot of chunk dp-congressman-sns-yt-crawl" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true"></a>yt_congress_stat_df &lt;-<span class="st"> </span><span class="kw">tibble</span>(</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true"></a>  <span class="dt">channel_id =</span> channel_id,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true"></a>  <span class="dt">view_count =</span> <span class="kw">map</span>(yt_congress_stat, <span class="op">~</span>.<span class="op">$</span>statistics<span class="op">$</span>viewCount) <span class="op">%&gt;%</span><span class="st"> </span>unlist <span class="op">%&gt;%</span><span class="st"> </span>as.integer,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true"></a>  <span class="dt">video_count =</span> <span class="kw">map</span>(yt_congress_stat, <span class="op">~</span>.<span class="op">$</span>statistics<span class="op">$</span>videoCount) <span class="op">%&gt;%</span><span class="st"> </span>unlist <span class="op">%&gt;%</span><span class="st"> </span>as.integer,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true"></a>  <span class="dt">subscriber_count =</span> <span class="kw">map</span>(yt_congress_stat, <span class="op">~</span>.<span class="op">$</span>statistics<span class="op">$</span>subscriberCount) <span class="op">%&gt;%</span><span class="st"> </span>unlist <span class="op">%&gt;%</span><span class="st"> </span>as.integer,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true"></a>  <span class="dt">comment_count =</span> <span class="kw">map</span>(yt_congress_stat, <span class="op">~</span>.<span class="op">$</span>statistics<span class="op">$</span>commentCount) <span class="op">%&gt;%</span><span class="st"> </span>unlist <span class="op">%&gt;%</span><span class="st"> </span>as.integer</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true"></a>) </span></code></pre></div>
<pre><code>Error: Tibble columns must have compatible sizes.
* Size 45: Existing data.
* Size 0: Column `view_count`.
i Only values of size one are recycled.</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true"></a>np_comp_yt_df &lt;-<span class="st"> </span>np_comp_yt_df <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true"></a><span class="st">   </span><span class="kw">filter</span>(channel_len <span class="op">==</span><span class="st"> </span><span class="dv">24</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">left_join</span>(yt_congress_stat_df)</span></code></pre></div>
<pre><code>Error in is.data.frame(y): object &#39;yt_congress_stat_df&#39; not found</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true"></a>yt_congress_stat_df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>view_count)) <span class="op">+</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_density</span>()</span></code></pre></div>
<pre><code>Error in ggplot(., aes(x = view_count)): object &#39;yt_congress_stat_df&#39; not found</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true"></a>yt_congress_stat_df <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">arrange</span>(<span class="op">-</span>view_count)</span></code></pre></div>
<pre><code>Error in arrange(., -view_count): object &#39;yt_congress_stat_df&#39; not found</code></pre>
<section class="footnotes" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p><a href="https://statkclee.github.io/ingest-data/naver-people-info.html">데이터 가져오기 - 네이버 인물정보</a><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2" role="doc-endnote"><p><a href="https://medium.com/@tumuhimbisemoses/youtube-data-mining-experiences-of-using-r-1419e9aefcc5">YouTube Data Mining : Experiences of using R.</a><a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
        </div>
      </div>
      </article>
      <div class="footer">
        <a class="label swc-blue-bg" href="http://software-carpentry.org">Software Carpentry</a>
        <a class="label swc-blue-bg" href="https://github.com/swcarpentry/lesson-template">Source</a>
        <a class="label swc-blue-bg" href="mailto:admin@software-carpentry.org">Contact</a>
        <a class="label swc-blue-bg" href="LICENSE.html">License</a>
      </div>
    </div>
    <!-- Javascript placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script src="css/bootstrap/bootstrap-js/bootstrap.js"></script>
    <script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>
  </body>
</html>
